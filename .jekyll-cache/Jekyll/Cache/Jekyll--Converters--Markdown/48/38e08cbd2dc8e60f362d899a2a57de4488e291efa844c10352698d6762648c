I"è*<h2 id="å‰è¨€">å‰è¨€</h2>
<p>dockeræ˜¯å¼€å‘äººå‘˜å’Œç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨å®¹å™¨å¼€å‘ã€éƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„å¹³å°ã€‚ä½¿ç”¨Linuxå®¹å™¨éƒ¨ç½²åº”ç”¨ç¨‹åºç§°ä¸ºå®¹å™¨åŒ–ã€‚å®¹å™¨ä¸æ˜¯æ–°çš„ï¼Œä½†æ˜¯å®ƒä»¬ç”¨äºè½»æ¾éƒ¨ç½²åº”ç”¨ç¨‹åºã€‚<br />
å®¹å™¨åŒ–çš„ä¼˜åŠ¿ï¼š<br />
1ã€çµæ´»ï¼Œå†å¤æ‚çš„åº”ç”¨ä¹Ÿå¯ä»¥é›†è£…ç®±åŒ–ã€‚<br />
2ã€è½»é‡çº§ï¼Œå®¹å™¨åˆ©ç”¨å¹¶å…±äº«ä¸»æœºå†…æ ¸ã€‚<br />
3ã€å¯äº’æ¢ï¼Œæ”¯æŒå³æ—¶éƒ¨ç½²æ›´æ–°å’Œå‡çº§ã€‚<br />
4ã€ä¾¿æºæ€§ï¼Œæˆ‘ä»¬å¯ä»¥æœ¬åœ°æ„å»ºï¼Œéƒ¨ç½²åˆ°äº‘ï¼Œå¹¶åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œã€‚<br />
5ã€å¯æ‰©å±•ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ å¹¶è‡ªåŠ¨åˆ†å‘å®¹å™¨å‰¯æœ¬ã€‚<br />
6ã€å¯å †å ï¼Œæˆ‘ä»¬å¯ä»¥å‚ç›´å’Œå³æ—¶å †å æœåŠ¡ã€‚<br />
<a href="https://docs.docker.com/get-started/">å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="æ­£æ–‡">æ­£æ–‡</h2>
<h4 id="æ¦‚å¿µ">æ¦‚å¿µ</h4>
<p>é•œåƒï¼šé€šè¿‡è¿è¡Œé•œåƒå¯åŠ¨å®¹å™¨ï¼Œé•œåƒæ˜¯ä¸€ä¸ªå¯æ‰§è¡Œçš„åŒ…ï¼Œå®ƒåŒ…å«è¿è¡Œåº”ç”¨çš„æ‰€æœ‰çš„å†…å®¹ï¼ŒåŒ…å«ä»£ç ã€ç¯å¢ƒã€é…ç½®æ–‡ä»¶ç­‰ã€‚<br />
å®¹å™¨ï¼šå®¹å™¨æ˜¯é•œåƒçš„è¿è¡Œæ—¶çš„å®ä¾‹ã€‚å¯ä»¥ä½¿ç”¨docker ps æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨åˆ—è¡¨ã€‚<br />
å®¹å™¨å’Œè™šæ‹Ÿæœºçš„å¯¹æ¯”ï¼š<br />
å®¹å™¨åœ¨Linuxä¸Šè¿è¡Œï¼Œå¹¶äºå…¶ä»–å®¹å™¨å…±äº«ä¸»æœºå†…æ ¸ã€‚å®ƒè¿è¡Œä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä¸å ç”¨ä»»ä½•å…¶ä»–çš„å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å­˜ï¼Œè¿™ä½¿å¾—å®ƒååˆ†çš„è½»é‡ã€‚
ç›¸æ¯”ä¹‹ä¸‹,è™šæ‹Ÿæœºè¿è¡Œä¸€ä¸ªå®Œæ•´çš„â€œå®¢æˆ·â€æ“ä½œç³»ç»Ÿï¼Œé€šè¿‡è™šæ‹Ÿæœºç®¡ç†ç¨‹åºå¯¹ä¸»æœºèµ„æºè¿›è¡Œè™šæ‹Ÿè®¿é—®ã€‚é€šå¸¸ï¼Œè™šæ‹Ÿæœºæä¾›çš„ç¯å¢ƒæ¯”å¤§å¤šæ•°åº”ç”¨ç¨‹åºéœ€è¦çš„èµ„æºå¤šã€‚<br />
CEç¤¾åŒºç‰ˆã€EEä¼ä¸šç‰ˆé‡ä½“è£è¡£å’¯ã€‚å‰è€…å…è´¹,åè€…æ”¶è´¹ï¼Œä½†æ˜¯æ›´å®‰å…¨ï¼Œå®˜ç½‘æœ‰è¯¦ç»†å™è¿°ã€‚<br /></p>

<h4 id="å®‰è£…docker">å®‰è£…docker</h4>
<p><a href="https://docs.docker.com/install/">TP</a> 
æ ¹æ®è‡ªå·±æ“ä½œç³»ç»Ÿçš„ä¸åŒè‡ªå·±é€‰æ‹©å®‰è£…æ–¹å¼ã€‚
<img src="/img/dockerå®‰è£….jpg" alt="çœ‹è¿™é‡Œ" /></p>
<h4 id="é•œåƒåŠ é€Ÿ">é•œåƒåŠ é€Ÿ</h4>
<p>dockerhubåœ¨å¢™å¤–é¢ï¼Œä¸‹é•œåƒå¾ˆæ…¢ã€‚æ‰€ä»¥â€¦<br /></p>
<h4 id="dockerå¸¸ç”¨å‘½ä»¤">dockerå¸¸ç”¨å‘½ä»¤</h4>
<p><strong>ç‰ˆæœ¬:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>docker --versioin ç‰ˆæœ¬ä¿¡æ¯
docker info dockerå®‰è£…ç»†èŠ‚,ä¸ºé¿å…æƒé™é”™è¯¯æœ€å¥½åŠ sudoè¿è¡Œ
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>å¸®åŠ©:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker --help
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>é•œåƒ:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>docker pull æ‹‰å–é•œåƒï¼Œä¸æŒ‡å®šDocker Registryé»˜è®¤Docker Hub
docker image ls/docker iamges  åˆ—å‡ºæ‰€æœ‰çš„é•œåƒ
docker system df é•œåƒä½“ç§¯
docker image prune åˆ é™¤dangling image
docker image ls imageName æ ¹æ®ä»“åº“ååˆ—å‡ºé•œåƒ
docker image rm imageName/imageId åˆ é™¤æœ¬åœ°é•œåƒ
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>å®¹å™¨:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>docker ps -l åˆ—å‡ºæœ€æ–°åˆ›å»ºçš„xä¸ªå®¹å™¨
docker ps -n=2 åˆ—å‡ºæœ€ånä¸ªå®¹å™¨
docker container ls åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker container ls -a/--all åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨
docker container ls -aq åˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨(qå®‰é™æ¨¡å¼ï¼šåªè¿”å›å®¹å™¨ID)
docker container run é•œåƒid ä»é•œåƒæ–‡ä»¶ç”Ÿæˆä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker start containerId å¯åŠ¨æŸä¸ªï¼ˆcontainerIdï¼‰å®¹å™¨
docekr run --restart containerId é‡å¯æŸä¸ªå®¹å™¨
docker run --restart=always containerId 
docker run -it -v /xxx/xx/x:/xx/x -p 4000:80 imageName 
    -it äº¤äº’å¼è¿›å…¥å®¹å™¨ -vç£ç›˜æ˜ å°„(é¿å…é¢‘ç¹åœ°åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸­æ‹·è´æ–‡ä»¶) -pç«¯å£æ˜ å°„(æŠŠæœ¬æœº4000ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„80ç«¯å£)
docker stop containerName/containerId é€€å‡ºæŸä¸ªå®¹å™¨ï¼ˆå®¹å™¨åç§°å¥½åƒä¸è¡Œï¼‰
docker kill containerName/containerId å¼ºåˆ¶é€€å‡ºæŸä¸ªå®¹å™¨
docker rm containerName/containerId åˆ é™¤æŸä¸ªå®¹å™¨
docker rm 'docker ps -a -q' åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼Œ-qåˆ—å‡ºæ‰€æœ‰çš„å®¹å™¨çš„IDï¼Œç„¶åä¼ é€’ç»™rmä¸€æ¬¡åˆ é™¤
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>æ„å»º:</strong></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>docker build . åˆ›å»ºé•œåƒä½¿ç”¨å½“å‰ç›®å½•ä½œä¸ºä¸Šä¸‹æ–‡ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¥½ä»ç©ºç›®å½•(é¡¹ç›®ç›®å½•)å¼€å§‹ä½œä¸ºä¸Šä¸‹æ–‡ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>
<h4 id="é•œåƒæ„å»º">é•œåƒæ„å»º</h4>
<p><strong>å‘½ä»¤ï¼š</strong>
docker build .
-f:æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿä¸­ä¸€ä¸ªDockerfileçš„ä½ç½®
-t:æ„å»ºæˆåŠŸæŒ‡å®šrepositoryå’Œtag</p>

<p>Dockerfileæ˜¯ä¸€ä¸ªæè¿°ç»„è£…é•œåƒæ­¥éª¤çš„æ–‡æ¡£ã€‚ä¸€èˆ¬è€Œè¨€Dockerfileæ˜¯å­˜äºé¡¹ç›®ç›®å½•ä¸‹çš„ã€‚ç‰¹åˆ«æ³¨æ„ä¸è¦å°†æ ¹ç›®å½•ä½œä¸ºPATHè·¯å¾„ï¼Œå› ä¸ºä¼šå¯¼è‡´è¿™æ¬¡æ„å»ºæ“ä½œå°†ç£ç›˜é©±åŠ¨å™¨çš„å…¨éƒ¨å†…å®¹ä¼ è¾“åˆ°Dockerå®ˆæŠ¤è¿›ç¨‹(daemon)ä¸­ã€‚ä¹Ÿå¯ä»¥é€šè¿‡æ·»åŠ .dockerignoreæ–‡ä»¶æ¥æ’é™¤æŸäº›æ–‡ä»¶å’Œç›®å½•ã€‚<br />
<strong>æ ¼å¼ï¼š</strong></p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="c1"># Comment
</span><span class="n">INSTRUCTION</span> <span class="n">arguments</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>å®˜æ–¹æ ·ä¾‹ï¼š</strong></p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="c1"># Use an official Python runtime as a parent image
</span><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">2.7</span><span class="o">-</span><span class="n">slim</span>

<span class="c1"># Set the working directory to /app
</span><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">app</span>

<span class="c1"># Copy the current directory contents into the container at /app
</span><span class="n">COPY</span> <span class="o">.</span> <span class="o">/</span><span class="n">app</span>

<span class="c1"># Install any needed packages specified in requirements.txt
</span><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">trusted</span><span class="o">-</span><span class="n">host</span> <span class="n">pypi</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># Make port 80 available to the world outside this container
</span><span class="n">EXPOSE</span> <span class="mi">80</span>

<span class="c1"># Define environment variable
</span><span class="n">ENV</span> <span class="n">NAME</span> <span class="n">World</span>

<span class="c1"># Run app.py when the container launches
</span><span class="n">CMD</span> <span class="p">[</span><span class="s">"python"</span><span class="p">,</span> <span class="s">"app.py"</span><span class="p">]</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p><strong>DockerfileæŒ‡ä»¤è§£é‡Šï¼š</strong></p>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre><span class="s">FROM:Dockerfileç¬¬ä¸€æ¡è¯­å¥ï¼Œå…¶æŒ‡å®šäº†æ„å»ºé•œåƒçš„åŸºç¡€é•œåƒã€‚ä¸€ä¸ªåˆæ³•çš„Dockerfileå¿…é¡»ä»¥FROMå¼€å§‹ã€‚</span>
    <span class="s">FROM &lt;image&gt; [AS &lt;name&gt;]</span>
    <span class="s">FROM &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span>
    <span class="s">FROM &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span>
<span class="s">RUN:RUNæŒ‡ä»¤å°†åœ¨å½“å‰é•œåƒä¸Šçš„æ–°çš„layeræ‰§è¡Œä»»ä½•å‘½ä»¤å¹¶æäº¤ç»“æœã€‚ç”Ÿæˆçš„å·²æäº¤é•œåƒç”¨äºDockerfileçš„ä¸‹ä¸€æ­¥ã€‚</span>
    <span class="s">RUN &lt;command&gt;</span>
    <span class="s">RUN ["executable","param1","param2"]</span>
<span class="s">CMD:ä¸ºæ‰§è¡Œå®¹å™¨æä¾›é»˜è®¤å€¼ã€‚</span>
    <span class="s">CMD ["executable","param1","param2"] (é¦–é€‰å½¢å¼)</span>
    <span class="s">CMD ["param1","param2"] (as default parameters to ENTRYPOINT)</span>
    <span class="s">CMD command param1 param2 (shell form)</span>
<span class="s">LABEL:ç»™é•œåƒæ·»åŠ å¤‡æ³¨ä¿¡æ¯ã€‚</span>
    <span class="s">LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt;</span> 
<span class="s">MAINTAINER:æŒ‡å®šé•œåƒä½œè€…ã€‚</span>
    <span class="s">MAINTAINER &lt;name&gt;</span>
<span class="s">EXPOSE:é€šçŸ¥Dockerå®¹å™¨åœ¨è¿è¡Œæ—¶ä¾¦å¬æ‰§è¡Œçš„ç½‘ç»œç«¯å£ã€‚</span>
    <span class="s">EXPOSE &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]</span>
<span class="s">ENV:è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</span>
    <span class="s">ENV &lt;key&gt; &lt;value&gt;</span>
    <span class="s">ENV &lt;key&gt;=&lt;value&gt;</span>
<span class="s">ADD:ä»srcå¤„å¤åˆ¶æ–°æ–‡ä»¶ã€ç›®å½•ã€è¿œç¨‹URLï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°destçš„é•œåƒæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</span>
    <span class="s">ADD [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dest&gt;</span>
    <span class="s">ADD [--chown=&lt;user&gt;:&lt;group&gt;] ["&lt;src&gt;",... "&lt;dest&gt;"] (this form is required for paths containing whitespace)</span>
<span class="s">COPY:ä»srcå¤„å¤åˆ¶æ–°æ–‡ä»¶ã€ç›®å½•ã€è¿œç¨‹URLï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°destçš„é•œåƒæ–‡ä»¶ç³»ç»Ÿä¸­ã€‚</span>
<span class="s">ENTRYPOINT:å…è®¸æ‚¨é…ç½®å°†ä½œä¸ºå¯æ‰§è¡Œæ–‡ä»¶è¿è¡Œçš„å®¹å™¨</span>
<span class="na">VOLUME</span><span class="pi">:</span>
<span class="na">USER</span><span class="pi">:</span>
<span class="s">WORKDIR:ä¸ºDockerfileä¸­çš„RUNã€CMDã€ENTRYPOINTã€COPYå’ŒADDæŒ‡ä»¤è®¾ç½®å·¥ä½œç›®å½•ã€‚å¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚</span>
<span class="na">ONBUILD</span><span class="pi">:</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
:ET